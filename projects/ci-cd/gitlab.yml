gitlab:
  image: gitlab/gitlab-ce:14.8.2-ce.0
  container_name: gitlab
  environment:
    GITLAB_OMNIBUS_CONFIG: |
      postgresql['enable'] = true
      postgresql['version'] = 13
      external_url 'http://${SERVER_IPv4}:8083'
  ports:
    - 8083:8083
  volumes:
    - /etc/localtime:/etc/localtime:ro
    - ${VOLUMES}/gitlab/config:/etc/gitlab
    - ${VOLUMES}/gitlab/backup:/var/opt/gitlab/backups
  restart: unless-stopped
gitlab-runner:
  container_name: gitlab-runner
  image: gitlab/gitlab-runner:alpine
  ports:
    - 8093:8093
  volumes:
    - /var/run/docker.sock:/var/run/docker.sock
    - /etc/localtime:/etc/localtime:ro
    - ${VOLUMES}/gitlab-runner:/etc/gitlab-runner
  restart: unless-stopped
